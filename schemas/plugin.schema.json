{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://raw.githubusercontent.com/untrustedmodders/plugify/main/schemas/plugin.schema.json",
  "type": "object",
  "description": "A plugin for Plugify.",
  "title": "Plugin",
  "required": [
    "name",
    "version",
    "description",
    "author",
    "website",
    "license",
    "entry",
    "language"
  ],
  "properties": {
    "version": {
      "type": "string",
      "description": "The semantic version (SemVer) of the plugin following the format MAJOR.MINOR.PATCH. Used for dependency resolution, compatibility checking, and update management.",
      "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
      "minLength": 1
    },
    "name": {
      "type": "string",
      "description": "The unique identifier for the plugin. Should be lowercase, use hyphens for spaces, and be descriptive (e.g., 'audio-manager', 'database-connector', 'logging-framework').",
      "pattern": "^[a-zA-Z][a-zA-Z0-9_.-]*$",
      "minLength": 1,
      "examples": ["audio-manager", "database-connector", "logging-framework"]
    },
    "description": {
      "type": "string",
      "description": "A comprehensive description of the plugin's functionality, features, and purpose. Should explain what problem it solves and its main capabilities."
    },
    "author": {
      "type": "string",
      "description": "The name or identifier of the plugin creator. Can be an individual name, username, or organization (e.g., 'John Doe', 'johndoe', 'Acme Corp').",
      "minLength": 1,
      "examples": ["John Doe", "jane-doe", "Acme Corporation", "Community Contributors"]
    },
    "website": {
      "type": "string",
      "description": "The official website, repository, or documentation URL for this plugin. Typically links to the project's GitHub repository, documentation site, or support page.",
      "pattern": "https?://(www\\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\\.[a-z]{2,4}\\b([-a-zA-Z0-9@:%_+.~#?&/=]*)"
    },
    "license": {
      "type": "string",
      "description": "The software license identifier for the plugin (e.g., 'MIT', 'Apache-2.0', 'GPL-3.0'). Should use SPDX license identifiers when possible. See https://spdx.org/licenses/",
      "minLength": 1,
      "examples": ["MIT", "Apache-2.0", "GPL-3.0", "BSD-3-Clause", "proprietary"]
    },
    "platforms": {
      "type": "array",
      "description": "Target platforms and architectures this plugin supports. Each entry should specify the OS and architecture in the format 'os_arch' (e.g., 'windows_x64', 'linux_arm64'). Leave empty to support all platforms.",
      "items": {
        "type": "string",
        "description": "Platform name.",
        "pattern": "^[a-z0-9]+(_(x64|arm64|x86|arm32|riscv32|riscv64))$",
        "minLength": 1,
        "examples": [
          "windows_x64",
          "steamrt_x64"
        ]
      }
    },
    "dependencies": {
      "type": "array",
      "description": "Other plugins required for this plugin to function properly. Dependencies are resolved and loaded before this plugin. Version constraints ensure compatibility between plugins.",
      "items": {
        "type": "object",
        "description": "Describes the properties of a plugin dependency.",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "The name of the plugin reference.",
            "pattern": "^[a-zA-Z][a-zA-Z0-9_.-]*$",
            "minLength": 1
          },
          "constraints": {
            "type": "string",
            "description": "A version constraint expression. Multiple constraints can be combined with spaces (AND) or '||' (OR). Example: '>=1.0.0 <2.0.0 || >3.2.1'.",
            "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
            "examples": [
              ">=1.0.0 <2.0.0",
              ">=1.0.0 <2.0.0 || >3.2.1",
              "==1.2.3 || >=2.0.0 <3.0.0"
            ]
          },
          "optional": {
            "type": "boolean",
            "description": "Indicates whether the plugin reference is optional."
          }
        },
        "additionalProperties": false
      }
    },
    "conflicts": {
      "type": "array",
      "description": "A list of plugin references specifying plugins that conflict with this plugin.",
      "items": {
        "type": "object",
        "description": "Plugins that are incompatible with this plugin. The plugin manager will prevent loading conflicting plugins simultaneously. Use this to prevent issues with plugins that provide overlapping or incompatible functionality.",
        "required": [
          "name"
        ],
        "properties": {
          "name": {
            "type": "string",
            "description": "The name of the conflicting plugin.",
            "pattern": "^[a-zA-Z][a-zA-Z0-9_.-]*$",
            "minLength": 1
          },
          "constraints": {
            "type": "string",
            "description": "A version constraint expression. Multiple constraints can be combined with spaces (AND) or '||' (OR). Example: '>=1.0.0 <2.0.0 || >3.2.1'.",
            "pattern": "^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)(?:-((?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\\+([0-9a-zA-Z-]+(?:\\.[0-9a-zA-Z-]+)*))?$",
            "examples": [
              ">=1.0.0 <2.0.0",
              ">=1.0.0 <2.0.0 || >3.2.1",
              "==1.2.3 || >=2.0.0 <3.0.0"
            ]
          },
          "reason": {
            "type": "string",
            "description": "The reason why this plugin conflicts with the specified plugin.",
            "minLength": 1
          }
        },
        "additionalProperties": false
      }
    },
    "language": {
      "type": "string",
      "description": "Specifies the programming language and language module required to run this plugin. The specified language module must be installed for the plugin to load.",
      "pattern": "^[a-zA-Z][a-zA-Z0-9_.-]*$",
      "minLength": 1,
      "examples": [
        "cpp",
        "csharp",
        "python3",
        "javascript",
        "golang",
        "lua"
      ]
    },
    "entry": {
      "type": "string",
      "description": "The entry point file or main executable for the plugin, relative to the plugin's directory. This is the file that will be loaded when the plugin starts (e.g., 'main.dll', 'plugin.so', 'index.js').",
      "minLength": 1,
      "examples": ["main.dll", "plugin.so", "index.js", "Plugin.cs", "plugin.py"]
    },
    "methods": {
      "type": "array",
      "description": "Public API methods exposed by this plugin for other plugins to call. These methods form the plugin's inter-plugin communication interface. Each method defines its signature, parameters, and return type for cross-language compatibility.",
      "items": {
        "$ref": "#/$defs/methodObject"
      }
    },
    "classes": {
      "type": "array",
      "description": "Object-oriented class wrappers that provide RAII (Resource Acquisition Is Initialization) semantics over handle-based APIs. Classes bundle related methods together and manage resource lifecycle through constructors and destructors.",
      "items": {
        "$ref": "#/$defs/classObject"
      }
    }
  },
  "$defs": {
    "methodObject": {
      "type": "object",
      "description": "An object describing single function/method exposed by the plugin.",
      "required": [
        "name",
        "funcName",
        "paramTypes",
        "retType"
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "The public API name for this method. This is the name other plugins will use to call this function. Should be descriptive and follow consistent naming conventions.",
          "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
          "minLength": 1
        },
        "group": {
          "type": "string",
          "description": "Optional categorization for documentation generation. Groups related methods together (e.g., 'File Operations', 'Network', 'Configuration'). Used to organize API documentation."
        },
        "description": {
          "type": "string",
          "description": "Detailed explanation of what this method does, including its purpose, behavior, side effects, and any important notes for callers."
        },
        "deprecated": {
          "type": "string",
          "description": "Marks the symbol as deprecated. Contains a human-readable message explaining why it is deprecated and what should be used instead. Absence means not deprecated."
        },
        "funcName": {
          "type": "string",
          "description": "The actual function name as implemented in the plugin's source code. This maps the public API name to the internal implementation. Must match exactly with the function name in your code.",
          "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
          "minLength": 1
        },
        "paramTypes": {
          "type": "array",
          "description": "Ordered list of parameters this method accepts. Each parameter defines its type, name, and optional metadata. The order must match the function signature exactly.",
          "items": {
            "type": "object",
            "description": "Parameter's information.",
            "required": [
              "name",
              "type"
            ],
            "properties": {
              "type": {
                "type": "string",
                "description": "The data type of this parameter value.The type system ensures cross-language compatibility.",
                "enum": ["void", "bool", "char8", "char16", "int8", "int16", "int32", "int64", "uint8", "uint16", "uint32", "uint64", "ptr64", "ptr32", "float", "double", "function", "string", "any", "bool[]", "char8[]", "char16[]", "int8[]", "int16[]", "int32[]", "int64[]", "uint8[]", "uint16[]", "uint32[]", "uint64[]", "ptr64[]", "float[]", "double[]", "string[]", "any[]", "vec2[]", "vec3[]", "vec4[]", "mat4x4[]", "vec2", "vec3", "vec4", "mat4x4"]
              },
              "name": {
                "type": "string",
                "description": "The parameter value name used in generated bindings and documentation. Should be descriptive and follow the target language's naming conventions.",
                "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
                "minLength": 1
              },
              "description": {
                "type": "string",
                "description": "Explanation of this parameter's purpose, valid ranges, special values. Include units of measurement where applicable."
              },
              "prototype": {
                "type": "object",
                "description": "For 'function' type parameters only. Defines the signature of the callback function or function pointer, including its parameters and return type.",
                "$ref": "#/$defs/methodObject"
              },
              "enum": {
                "type": "object",
                "description": "For enum type parameters. Defines the enumeration structure including all possible values and their integer mappings. Used for type-safe enum passing between plugins.",
                "$ref": "#/$defs/enumObject"
              },
              "default": {
                "type": ["string", "number", "boolean"],
                "description": "Optional default value for this parameter. If provided, the parameter becomes optional in languages that support default arguments. Must be a valid value for the parameter's type.",
                "examples": ["defaultValue", 42, true]
              }
            }
          },
          "maxItems": 32
        },
        "retType": {
          "type": "object",
          "description": "The return value specification for this method. Defines what type of data the method returns, if any. Use type 'void' for methods that don't return a value.",
          "required": [
            "type"
          ],
          "properties": {
            "type": {
              "type": "string",
              "description": "The data type of this return value.The type system ensures cross-language compatibility.",
              "enum": ["void", "bool", "char8", "char16", "int8", "int16", "int32", "int64", "uint8", "uint16", "uint32", "uint64", "ptr64", "ptr32", "float", "double", "function", "string", "any", "bool[]", "char8[]", "char16[]", "int8[]", "int16[]", "int32[]", "int64[]", "uint8[]", "uint16[]", "uint32[]", "uint64[]", "ptr64[]", "float[]", "double[]", "string[]", "any[]", "vec2[]", "vec3[]", "vec4[]", "mat4x4[]", "vec2", "vec3", "vec4", "mat4x4"]
            },
            "name": {
              "type": "string",
              "description": "The return value name used in generated bindings and documentation. Should be descriptive and follow the target language's naming conventions.",
              "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
              "minLength": 1
            },
            "description": {
              "type": "string",
              "description": "Meaning of the return value. Include units of measurement where applicable."
            },
            "prototype": {
              "type": "object",
              "description": "For 'function' type returns only. Defines the signature of the callback function or function pointer, including its parameters and return type.",
              "$ref": "#/$defs/methodObject"
            },
            "enum": {
              "type": "object",
              "description": "For enum type returns. Defines the enumeration structure including all possible values and their integer mappings. Used for type-safe enum passing between plugins.",
              "$ref": "#/$defs/enumObject"
            }
          }
        }
      }
    },
    "enumObject": {
      "type": "object",
      "description": "An object describing enum structure.",
      "required": [
        "name",
        "values"
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "The type name for this enumeration. Will be used to generate enum types in target languages. Should follow PascalCase naming convention.",
          "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
          "minLength": 1
        },
        "description": {
          "type": "string",
          "description": "Explanation of what this enumeration represents and how it should be used. Include any important notes about the values or their relationships."
        },
        "values": {
          "type": "array",
          "description": "Enum's entries.",
          "items": {
            "type": "object",
            "description": "The complete list of enumeration values. Each value has a unique name and integer mapping. Values are used for cross-language enum compatibility.",
            "required": [
              "name",
              "value"
            ],
            "properties": {
              "name": {
                "type": "string",
                "description": "The identifier for this enum value. Should follow UPPER_SNAKE_CASE or the appropriate convention for the target language. Must be unique within the enum.",
                "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
                "minLength": 1
              },
              "description": {
                "type": "string",
                "description": "Explanation of what this enum value represents, when it should be used, and any special behavior associated with it."
              },
              "value": {
                "type": "integer",
                "description": "The integer value mapped to this enum entry. Must be unique within the enum. Used for consistent cross-language enum representation."
              }
            },
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": false
    },
    "classObject": {
      "type": "object",
      "description": "An object describing a class wrapper for handle-based resources.",
      "required": [
        "name",
        "handleType",
        "invalidValue",
        "bindings"
      ],
      "properties": {
        "name": {
          "type": "string",
          "description": "The class name. Should follow PascalCase naming convention and be descriptive of the resource it manages.",
          "pattern": "^[A-Z][a-zA-Z0-9_]*$",
          "minLength": 1
        },
        "group": {
          "type": "string",
          "description": "Optional categorization for documentation generation. Groups related methods together (e.g., 'File Operations', 'Network', 'Configuration'). Used to organize API documentation."
        },
        "description": {
          "type": "string",
          "description": "Detailed explanation of what this class represents, its purpose, and how it manages the underlying resource. Include any important lifecycle or usage notes."
        },
        "deprecated": {
          "type": "string",
          "description": "Marks the symbol as deprecated. Contains a human-readable message explaining why it is deprecated and what should be used instead. Absence means not deprecated."
        },
        "handleType": {
          "type": "string",
          "description": "The data type used for the underlying handle that this class wraps. Typically ptr64 or ptr32, but may support other types depending on the resource.",
          "enum": ["void", "bool", "char8", "char16", "int8", "int16", "int32", "int64", "uint8", "uint16", "uint32", "uint64", "ptr64", "ptr32", "float", "double"]
        },
        "invalidValue": {
          "type": "string",
          "description": "The value that represents an invalid or null handle. Used to check if a handle is valid or to initialize handles before construction.",
          "examples": ["0", "-1"]
        },
        "constructors": {
          "type": "array",
          "description": "List of method names that can be used to construct instances of this class. Each constructor should return a handle of the specified handleType. Multiple constructors allow different initialization patterns.",
          "items": {
            "type": "string",
            "description": "The name of a method that serves as a constructor for this class. Must reference an existing method in the 'methods' array.",
            "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
            "minLength": 1
          },
          "minItems": 1
        },
        "destructor": {
          "type": ["string", "null"],
          "description": "The method name used to destroy instances of this class and release resources. Called automatically when the object goes out of scope in RAII-supporting languages. Must reference an existing method in the 'methods' array.",
          "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
          "minLength": 1
        },
        "bindings": {
          "type": "array",
          "description": "Instance bindings available on this class. Each binding references an existing function from the plugin's methods array and specifies whether the handle should be automatically bound as the first parameter.",
          "items": {
            "type": "object",
            "description": "A method binding that wraps an existing plugin method for use with this class.",
            "required": [
              "name",
              "method"
            ],
            "properties": {
              "name": {
                "type": "string",
                "description": "The name of this method as it will appear on class instances. Should follow camelCase or PascalCase naming convention appropriate for the target language.",
                "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
                "minLength": 1
              },
              "method": {
                "type": "string",
                "description": "The name of the plugin method to bind to this class method. Must reference an existing method in the plugin's 'methods' array. The referenced method's signature will be used, with optional self-binding.",
                "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
                "minLength": 1
              },
              "bindSelf": {
                "type": "boolean",
                "description": "If true, the class instance handle is automatically bound as the first parameter when calling this method, and the first parameter is dropped from the method signature. If false, the method is called as-is without automatic handle binding (useful for static methods)."
              },
              "paramAliases": {
                "type": "array",
                "description": "Optional array of aliases for the method's parameters. Each alias provides an alternative name for the corresponding parameter at that position. The array length must match the number of parameters in the referenced method (after bindSelf is applied). Use this to provide more meaningful or language-appropriate parameter names.",
                "items": {
                  "type": ["object", "null"],
                  "description": "An alias for a parameter with optional ownership semantics.",
                  "required": ["name"],
                  "properties": {
                    "name": {
                      "type": "string",
                      "description": "The aliased parameter name.",
                      "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
                      "minLength": 1
                    },
                    "owner": {
                      "type": "boolean",
                      "description": "Optional boolean indicating ownership semantics for this parameter. When true, indicates that this parameter takes ownership of the resource (e.g., for move semantics or transfer of ownership)."
                    }
                  },
                  "additionalProperties": false
                },
                "maxItems": 32
              },
              "retAlias": {
                "type": ["object", "null"],
                "description": "Optional alias for the return value. Provides an alternative name and ownership semantics for the value returned by this method. Useful for providing more meaningful or language-appropriate return value names in generated bindings.",
                "required": ["name"],
                "properties": {
                  "name": {
                    "type": "string",
                    "description": "The aliased return value name.",
                    "pattern": "^[a-zA-Z_][a-zA-Z0-9_]*$",
                    "minLength": 1
                  },
                  "owner": {
                    "type": "boolean",
                    "description": "Optional boolean indicating ownership semantics for the return value. When true, indicates that the caller takes ownership of the returned resource."
                  }
                },
                "additionalProperties": false
              }
            }
          },
          "minItems": 1
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
